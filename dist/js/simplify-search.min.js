function simplifySearch(e){"use strict";function t(){if(null===W)throw"not find form (id = "+D.formId+")";return D.hideForm===!0&&(W.style.display="none"),c(),B=new R,h(null,!0),compatibleJs.addEventListener(K,"keydown",T),compatibleJs.addEventListener(K,"keydown",B.controlBaseEvent),compatibleJs.addEventListener(K,"keyup",I),compatibleJs.addEventListener(document,"click",E),compatibleJs.addEventListener(K,"click",N),Z}function n(){L()}function i(){w()}function a(e,t){var n=document.getElementById(e);return void 0===n||null===n?(compatibleJs._warning('function addRegexpById : getElementById("'+e+'") no exist'),Z):o(n,t)}function o(e,t){if(!(e instanceof Element))throw"param not HTML DOM Nodes";if(void 0===t&&(!t||"function"!=typeof t.test))throw"Param does not have test(), pleast use RegExp object or create function test()";return F(e,t),Z}function s(e){var t=document.getElementById(e);return void 0===t||null===t?(compatibleJs._warning('function addIgnoreById : getElementById("'+e+'") no exist'),Z):r(t)}function r(e){if(!(e instanceof Element))throw"param not HTML DOM Nodes";return b(e),Z}function l(e,t){var n=e.replace(/\[.*\]/g,"");return void 0===H[n]&&(H[n]=new P),H[n].setTitleFn(t),Z}function u(){return{config:D,configRegExpList:$,configIgnoreList:V,autoCompleteList:X,nodeDataList:H,autoNode:K,menuObj:B,formNode:W}}function c(){var e;K=K||document.getElementById(D.autoFeildId),null===K&&(e=document.createElement("input"),e.id=D.autoFeildId,e.type="input",e.className=D.autoFeildClass,W.parentNode.insertBefore(e,W),K=e)}function d(e){var t,n=v(e),i="";return void 0===e.name||null===e.name||""===e.name?"":(t=e.name.replace(/\[.*\]/g,""),void 0!==H[t]&&void 0!==H[t].title?H[t].title:(n!==Q.INPUT_RADIO&&n!==Q.INPUT_CHECKBOX&&(i=f(e,W),D.usePlaceholder&&""===i&&(n===Q.INPUT_TEXT||n===Q.TEXTAREA)&&e.getAttribute("placeholder")&&(i=e.getAttribute("placeholder").trim())),""===i&&(i=t),i))}function h(e,t,n){var i,a,o,s,r=H;for(X=[],H={},i=0;void 0!==(a=W[i++]);)if(null===a.getAttribute("data-ignore-flag")&&a!==K&&(o=v(a),o!==Q.NOALLOW&&(null===a.getAttribute("disabled")||"disabled"!==a.getAttribute("disabled")&&""!==a.getAttribute("disabled"))&&(null===a.getAttribute("readonly")||"disabled"!==a.getAttribute("readonly")&&""!==a.getAttribute("readonly"))))switch(o){case Q.INPUT_NUMBER:case Q.INPUT_DATE:case Q.INPUT_TIME:p(new _(a)),t&&compatibleJs.addEventListener(a,"change",h);break;case Q.INPUT_EMAIL:case Q.INPUT_URL:case Q.TEXTAREA:case Q.INPUT_TEXT:p(new _(a)),t&&compatibleJs.addEventListener(a,"blur",g);break;case Q.INPUT_RADIO:case Q.INPUT_CHECKBOX:p(new S(a)),t&&compatibleJs.addEventListener(a,"change",g);break;case Q.SELECT_ONE:case Q.SELECT_MULTIPLE:m(a),t&&compatibleJs.addEventListener(a,"change",g)}if(n)for(s in H)H[s].defaultArr=r[s].defaultArr;O()}function g(e){var t,n,i=compatibleJs.eventCompatible(e),a=i.target;if(void 0===a||null===a||void 0===a.name)return void h(null,!1,!0);switch(n=v(a),t=a.name.replace(/\[.*\]/g,""),n){case Q.INPUT_NUMBER:case Q.INPUT_DATE:case Q.INPUT_TIME:case Q.INPUT_EMAIL:case Q.INPUT_URL:case Q.TEXTAREA:case Q.INPUT_TEXT:H[t].changeItemObjFn(new _(a));break;case Q.INPUT_RADIO:case Q.INPUT_CHECKBOX:H[t].changeItemObjFn(new S(a));break;case Q.SELECT_ONE:case Q.SELECT_MULTIPLE:m(a,!0);break;default:return void compatibleJs._warning("TagType of node is unknow.")}M()}function p(e,t){var n=e.name;void 0===H[n]&&(H[n]=new P),H[n].addItemObjFn(e,t),e.usedFlag&&X.push(new U(e.text,e))}function f(e,t){var n;if("LABEL"==e.parentNode.tagName)return n=e.parentNode.textContent.trim();if(!e.id)return"";var i=compatibleJs.getElementsByAttribute("for",e.id,"label",t);return 1!=i.length?"":n=i[0].textContent.trim()}function m(e,t){var n,i,a=e.name.replace(/\[.*\]/g,""),o=null!==e.getAttribute("multiple");if(1!=e.length){i=H[a],H[a]=void 0;for(var s=0;s<e.length;s++)(D.ignoreEmptyValue!==!0||""!==e[s].value&&void 0!==e[s].value&&null!==e[s].value)&&(null!==e[s].getAttribute("disabled")&&"disabled"!==e[s].getAttribute("disabled")&&""!==e[s].getAttribute("disabled")||"OPTION"==e[s].tagName&&(n=new k(s,a,o,e[s]),p(n,e)));t&&(H[a].defaultArr=i.defaultArr)}}function v(e){var t;if(void 0===e||null===e)return Q.NOALLOW;switch(e.tagName){case"SELECT":return e.getAttribute("multiple")?Q.SELECT_MULTIPLE:Q.SELECT_ONE;case"INPUT":return e.getAttribute("type")&&(t=e.type.toLowerCase()),t&&"text"!=t?"radio"==t?Q.INPUT_RADIO:"checkbox"==t?Q.INPUT_CHECKBOX:"number"==t?Q.INPUT_NUMBER:"date"==t?Q.INPUT_DATE:"time"==t?Q.INPUT_TIME:"email"==t?Q.INPUT_EMAIL:"url"==t?Q.INPUT_URL:Q.NOALLOW:Q.INPUT_TEXT;case"TEXTAREA":return Q.TEXTAREA;case"OPTION":return Q.OPTION;default:return Q.NOALLOW}}function b(e){var t,n;if(Q.NOALLOW===v(e))return compatibleJs._warning("Not allow "+e.tagName),!1;if("OPTION"==e.tagName){if(n=e.parentNode,"OPTGROUP"==n.tagName&&(n=n.parentNode),"SELECT"!=n.tagName||void 0===n.name)return compatibleJs._warning("No find parent node <select>, so failed to ignore <option>"),!1;t=n.name.replace(/\[.*\]/g,"")}else void 0!==e.name&&(t=e.name.replace(/\[.*\]/g,""));return void 0===t?(compatibleJs._warning("This node doesn't have name"),!1):(void 0!==H[t]&&("SELECT"==e.tagName?H[t].parentNode===e&&(H[t]=void 0):H[t].removeItemObjFn(e)),-1==compatibleJs.arrayIndexOf(V,e)&&(e.setAttribute("data-ignore-flag",V.length),V.push(e)),!0)}function F(e,t){var n,i;if("INPUT"!=e.tagName&&"TEXTAREA"!=e.tagName)return!1;if("INPUT"==e.tagName){if(n=e.type,void 0!==n&&(n=n.toLowerCase(),-1==compatibleJs.arrayIndexOf(G,n)))return!1;if("radio"==n||"checkbox"==n)return!1}return i=e.name.replace(/\[.*\]/g,""),void 0!==H[i]&&H[i].changeRegexpFn(e,t),e.setAttribute("data-regexp-flag",$.length),$.push({node:e,regexp:t}),!0}function T(e){var t=compatibleJs.eventCompatible(e);Y=compatibleJs.getKeyinPosition(K),null===B.getMenuNodeFn()&&e.keyCode===q.DOWN&&t.preventDefault()}function N(e){T(e);var t,n,i;if(null===B.getMenuNodeFn())for(t=K.value.slice(0,Y).length,n=X.length;void 0!==(i=X[--n]);)if(i.sort<=t){i.sort+i.getTextFn().length>=t&&x(n,!0);break}}function E(e){var t=compatibleJs.eventCompatible(e);document.activeElement!==K&&t.target!==K&&C(e)}function I(e){var t,n,i,a,o,s,r,l,u=compatibleJs.eventCompatible(e),c=K.value.trim(),d=[],h=[],g=!1;if(""===c)g=!0,h=X;else{for(c=" "+c+" ",a=0;void 0!==(o=X[a++]);)void 0!==o&&(i=" "+o.getTextFn()+" ",t=c.indexOf(i),-1!==t?(c=c.replace(i,new Array(i.length+1).join(" ")),o.sort=t,d.push(o)):(g=!0,h.push(o)));for(;""!==c.trim();)g=!0,t=c.search(/\S/i),n=c.indexOf(" ",t),i=c.substring(t,n),c=c.replace(i,new Array(i.length+1).join(" ")),o=new U(i),o.sort=t,d.push(o);d.sort(function(e,t){return e.sort-t.sort})}if(g){for(a=0;void 0!==(o=h[a++]);)s=o.getObjFn(),void 0!==s&&(r=s.name,s.cancelFn(),o.removeObjFn());B.removeMenuNodeFn(),X=d,A()}else if(null===B.getMenuNodeFn())switch(e.keyCode){case q.SPACE:for(l=K.value.slice(0,Y).length,a=X.length;void 0!==(o=X[--a]);){if(l<o.sort&&l>=o.sort-2&&void 0!==o.getObjFn()&&void 0!==X[a-1].getObjFn()){C(e,a-1);break}if(l>o.sort-2)break}break;case q.TAB:C(e);break;case q.DOWN:for(l=K.value.slice(0,Y).length,a=X.length;void 0!==(o=X[--a]);)if(o.sort<=l){o.sort+o.getTextFn().length>=l&&(x(a,!0),u.preventDefault());break}}}function A(e){for(var t,n=void 0!==e&&e<X.length-1?e:X.length-1;n>=0;n--)t=x(n),t!==!0&&t!==!1&&/^\d+$/.test(t)&&(n=t)}function x(e,t){var n,i,a,o,s,r,l=X[e],u=[],c=[];if(void 0===l)return!1;if(u.push(e),void 0!==l.getObjFn()){if(t!==!0)return!1;if(o=l.getObjFn().name,void 0===H[o])return!1;for(i=-1;void 0!==(s=H[o].itemObjs[++i]);)s.usedFlag?s===l.getObjFn()&&(a={name:o,index:i,sort:-1}):c.push({name:o,index:i,sort:i});return B.createChangeMenuFn(a,u,c),!0}for(a=l.getTextFn(),i=e;void 0!==(n=X[--i])&&void 0===n.getObjFn();)u.unshift(i),a=n.getTextFn()+" "+a;for(i=e;void 0!==(n=X[++i])&&void 0===n.getObjFn();)u.push(i),a=a+" "+n.getTextFn();for(o in H)if(void 0!==H[o]&&!H[o].noShowInMenuFlag)for(i=-1;void 0!==(s=H[o].itemObjs[++i]);)s.usedFlag||(s instanceof _?s.checkRuleFn(a)===!0&&(r=s.regexp===z.ANY?500:100,c.push({name:o,index:i,sort:r})):s instanceof j?-1!==s.text.toLowerCase().indexOf(a.valueOf().toLowerCase())&&(r=s.text.length==a.valueOf().length?1:1e3,c.push({name:o,index:i,sort:r})):compatibleJs._warning("unknow ItemObj class"));return c.sort(function(e,t){return e.sort-t.sort}),0===c.length?(B.removeMenuNodeFn(),B.createMsgMenuFn(a,u),-1):(B.createSelectMenuFn(a,u,c),!0)}function y(e,t){var n="";-1===e&&t&&(n=" ");for(var i=0;i<X.length;i++)X[i].sort=n.length,n=n+X[i].getTextFn()+" ",e===i&&t&&(n+=" ");return n}function O(e,t){var n,i;K.value=y(e,t),-1===e?t&&compatibleJs.setKeyinPosition(K,0):void 0!==e&&(n=X[e],i=n.sort+n.getTextFn().length+(t?1:0),compatibleJs.setKeyinPosition(K,i))}function M(){var e,t,n;X=[];for(e in H)if(H[e].multiple!==!1||H[e].noShowInMenuFlag!==!1)for(n=0;void 0!==(t=H[e].itemObjs[n++])&&(t.usedFlag!==!0||(X.push(new U(t.text,t)),H[e].multiple!==!1)););O()}function C(e,t){var n,i,a=[],o=0;for(i=0;void 0!==(n=X[i++]);)void 0===n.getObjFn()?o=o+n.getTextFn().length+1:(n.sort=n.sort-o,a.push(n));X.length!=a.length&&(X=a,void 0!==t?O(t,!0):O(),B.removeMenuNodeFn("select")),B.removeMenuNodeFn("msg")}function L(){var e,t,n;for(e in H)if(H[e].defaultArr=[],H[e].multiple!==!1||H[e].noShowInMenuFlag!==!1)for(n=0;void 0!==(t=H[e].itemObjs[n++]);)t.usedFlag===!0&&(t instanceof _?H[e].defaultArr.push(t.value):H[e].defaultArr.push(t.node))}function w(){var e,t,n,i,a;for(e in H){for(a=!1,i=-1;void 0!==(t=H[e].itemObjs[++i]);)t instanceof _?(n=H[e].defaultArr[i],void 0===n||""===n?t.cancelFn():(t.setTextFn(n),t.activeFn(),a=!0)):(t instanceof S||t instanceof k)&&(-1!==compatibleJs.arrayIndexOf(H[e].defaultArr,t.node)?(t.activeFn(),a=!0):t.cancelFn());a===!0&&H[e].multiple===!1?H[e].noShowInMenuFlag=!0:H[e].noShowInMenuFlag=!1}M()}function P(){this.title=void 0,this.defaultArr=[],this.multiple=!1,this.noShowInMenuFlag=!1,this.itemObjs=[],this.parentNode=null}function U(e,t){var n=e,i=t;this.sort=0,this.setObjFn=function(e){var t;return e instanceof j?(void 0!==i&&(t=i,t.cancelFn()),n=e.text,i=e,i.activeFn(),H[i.name].checkNoShowFlagFn(!0),void(void 0!==t&&i.name!==t.name&&H[t.name].checkNoShowFlagFn(!1))):void compatibleJs._warning("setObjFn: argument is not ItemObj")},this.getObjFn=function(){return i},this.setTextFn=function(e){n=e},this.getTextFn=function(){return n},this.removeObjFn=function(){void 0!==i&&(i.cancelFn(),H[i.name].checkNoShowFlagFn(!1),i=void 0)}}function j(e){this.node=e,this.name=void 0!==e.name?e.name.replace(/\[.*\]/g,""):void 0,this.multiple=this.name!==e.name,this.usedFlag=!1,this.text=void 0,this.value=e.value}function _(e){j.call(this,e);var t,n=e.getAttribute("data-regexp-flag"),i=v(e);if(this.regexp=void 0,this.maxlength=e.getAttribute("maxlength"),this.min=e.getAttribute("min"),this.max=e.getAttribute("max"),(null===this.maxlength||this.maxlength<0)&&(this.maxlength=NaN),null!==n)if(void 0!==$[n]&&$[n].node===e)this.regexp=$[n].regexp;else for(t=$.length-1;t>=0;t++)if($[t].node===e){this.regexp=$[t].regexp;break}if(void 0===this.regexp)switch(i){case Q.INPUT_NUMBER:this.regexp=z.NUMBER,null!==this.min&&(this.min=+this.min),null!==this.max&&(this.max=+this.max);break;case Q.INPUT_URL:this.regexp=z.URL;break;case Q.INPUT_EMAIL:this.regexp=z.EMAIL;break;case Q.INPUT_DATE:this.regexp=z.DATE;break;case Q.INPUT_TIME:this.regexp=z.TIME;break;default:this.regexp=z.ANY}""!==this.node.value&&(this.regexp.test(this.node.value)===!0?this.text=this.node.value:(compatibleJs._warning("value of [name="+e.name+"] don't match regexp, so delete the value"),this.node.value="")),this.usedFlag=""!==this.node.value}function k(e,t,n,i){j.call(this,i),this.name=t,this.selectedIndex=e,this.usedFlag=i.selected===!0,this.text=i.text,this.multiple=n}function S(e){j.call(this,e),this.usedFlag=e.checked===!0,this.text=f(e,W),""===this.text&&(this.text=this.value)}function R(){var e=null,t="";this.height=K.offsetHeight||K.clientHeight,this.width=K.offsetWidth||K.clientWidth,this.top=K.offsetTop||K.clientTop,this.left=K.offsetLeft||K.clientLeft,this.tagClass=D.tagClass,this.id="ssj-menu-"+J,this["class"]=D.menuClass,this.hideTag=D.hideTag,this.firstItemHideFlag=!0,this.setTypeFn=function(e){t=e},this.getTypeFn=function(){return t},this.setMenuNodeFn=function(t){null!==e&&this.removeMenuNodeFn(),e=t,K.parentNode.appendChild(t)},this.getMenuNodeFn=function(){return e},this.removeMenuNodeFn=function(n){void 0!==n&&t!=n||null!==e&&(e.remove(),e=null,t="")}}var B,J=Math.random().toString().slice(2),D={formId:e.formId||"",autoFeildId:e.autoFeildId||"ssj-"+J,hideForm:void 0!==e.hideForm?!!e.hideForm:!0,hideTag:void 0!==e.hideTag?!!e.hideTag:!1,ignoreEmptyValue:void 0!==e.ignoreEmptyValue?!!e.ignoreEmptyValue:!0,debugMode:void 0!==e.debugMode?!!e.debugMode:!1,delay:void 0!==e.delay?+e.delay:300,autoFeildClass:e.autoFeildClass||"",menuClass:e.menuClass||"ssj-menu",msgClass:e.msgClass||"ssj-msg",tagClass:e.tagClass||"ssj-tag",usePlaceholder:void 0!==e.usePlaceholder?!!e.usePlaceholder:!0},H={},X=[],W=document.getElementById(D.formId),K=null,$=[],V=[],Y=0,q={UP:38,DOWN:40,SPACE:32,ENTER:13,ESC:27,BACKSPACE:8,DELETE:46,TAB:9},z={ANY:/^.+$/,NUMBER:/^\d+$/,EMAIL:/^[^ @]+@[^ @%]+$/,DATE:{test:function(e){if(/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/.test(e)===!1)return!1;var t=new Date(e);return!isNaN(t.valueOf())}},TIME:{test:function(e){if(/^[0-9]{2}:[0-9]{2}$/.test(e)===!1)return!1;var t=e.split(":");return+t[0]<0||+t[0]>=24?!1:!(+t[1]<0||+t[1]>60)}},URL:/^\w+:\/\/.*$/},G=["text","radio","checkbox","url","email","tel","date","number"],Q={NOALLOW:0,INPUT_TEXT:1,INPUT_RADIO:2,INPUT_CHECKBOX:3,INPUT_URL:4,INPUT_EMAIL:5,INPUT_DATE:7,INPUT_TIME:13,INPUT_NUMBER:8,TEXTAREA:9,SELECT_ONE:10,SELECT_MULTIPLE:11,OPTION:12},Z={init:t,save:n,reset:i,addRegexpByDom:o,addRegexpById:a,addIgnoreByDom:r,addIgnoreById:s,setTitleByName:l};return D.debugMode&&(Z.log=u),P.prototype.setTitleFn=function(e){this.title=e},P.prototype.removeItemObjFn=function(e){var t,n,i;if("SELECT"!=e.tagName)for(t=-1;void 0!==(n=this.itemObjs[++t]);)if(n.node===e){this.itemObjs.splice(t,1),n instanceof _?this.defaultArr.splice(t,1):(i=compatibleJs.arrayIndexOf(this.defaultArr,e),-1!==i&&this.defaultArr.splice(i,1));break}},P.prototype.changeRegexpFn=function(e,t){for(var n,i=-1;void 0!==(n=this.itemObjs[++i]);){if(!(n instanceof _))return void compatibleJs._warning("This dom cannot set RegExp");if(n.node===e){n.setRegexpFn(t),n.checkRuleFn(this.defaultArr[i])||(compatibleJs._warning("Text default value be cleared! because does not match for new RegExp."),this.defaultArr[i]="");break}}},P.prototype.addItemObjFn=function(e,t){var n,i;if(this.title=this.title||d(t||e.node),this.multiple=this.multiple||e.multiple,this.itemObjs.push(e),e instanceof _)this.defaultArr.push(e.value),e.usedFlag&&!this.multiple&&(this.noShowInMenuFlag=!0);else if(e instanceof k){if(null===this.parentNode&&void 0!==t&&(this.parentNode=t),0===this.defaultArr.length)for(n=0;void 0!==(i=t.selectedOptions[n++]);)this.defaultArr.push(i);e.usedFlag&&(this.multiple||(this.noShowInMenuFlag=!0))}else e instanceof j&&e.usedFlag&&(this.defaultArr.push(e.node),this.multiple||(this.noShowInMenuFlag=!0))},P.prototype.changeItemObjFn=function(e){var t,n;for(t=-1;void 0!==(n=this.itemObjs[++t]);)if(n.node===e.node){this.itemObjs[t]=e,this.multiple===!1&&n.usedFlag!==e.usedFlag&&(this.noShowInMenuFlag=e.usedFlag);break}},P.prototype.checkNoShowFlagFn=function(e){if(this.multiple)return void(this.noShowInMenuFlag=!1);if(e===!0)return void(this.noShowInMenuFlag=!0);if(e===!1)return void(this.noShowInMenuFlag=!1);for(var t,n=0;void 0!==(t=this.itemObjs[n++]);)if(t.usedFlag===!0)return void(this.noShowInMenuFlag=!0);this.noShowInMenuFlag=!1},j.prototype.activeFn=function(){this.usedFlag=!0},j.prototype.cancelFn=function(){this.usedFlag=!1},_.prototype=Object.create(j.prototype),_.prototype.constructor=_,_.prototype.activeFn=function(){j.prototype.activeFn.call(this),this.node.value=this.text},_.prototype.cancelFn=function(){j.prototype.cancelFn.call(this),this.node.value="",this.text=""},_.prototype.setTextFn=function(e){this.text=e},_.prototype.setRegexpFn=function(e){this.regexp=e},_.prototype.checkRuleFn=function(e){return this.regexp.test(e)!==!0?!1:isNaN(this.maxlength)===!1&&e.length>this.maxlength?!1:null!==this.min&&e<this.min?!1:!(null!==this.max&&e>this.max)},k.prototype=Object.create(j.prototype),k.prototype.constructor=k,k.prototype.activeFn=function(){j.prototype.activeFn.call(this),this.node.selected=!0},k.prototype.cancelFn=function(){j.prototype.cancelFn.call(this),this.node.selected=!1},S.prototype=Object.create(j.prototype),S.prototype.constructor=S,S.prototype.activeFn=function(){j.prototype.activeFn.call(this),this.node.checked=!0},S.prototype.cancelFn=function(){j.prototype.cancelFn.call(this),this.node.checked=!1},R.prototype.createBaseMenuFn=function(e,t,n,i){if(null===this.getMenuNodeFn()){var a,o,s,r,l,u,c,d,h,g=document.createElement("ul");for(g.id=this.id,g.className=this["class"],g.setAttribute("data-select",0),g.setAttribute("data-auto-no",t.join(",")),g.style.position="absolute",g.style.zIndex=99,g.style.top=this.top+this.height+"px",g.style.left=this.left+"px",g.style.minWidth=this.width+"px",a=document.createElement("li"),"object"==typeof e?(u=e.name,c=e.index,d=H[u].itemObjs[c],h=d.text,a.setAttribute("data-name",u),a.setAttribute("data-index",c),a.appendChild(document.createTextNode(h)),this.hideTag===!1&&(l=H[u].title,""!==l&&void 0!==l&&(o=document.createElement("span"),o.className=this.tagClass,o.appendChild(document.createTextNode(l)),a.appendChild(o)))):(a.setAttribute("data-name",""),a.setAttribute("data-index",""),a.appendChild(document.createTextNode(e))),this.firstItemHideFlag&&(a.style.display="none"),a.className="focus",compatibleJs.addEventListener(a,"click",i),g.appendChild(a),s=0;void 0!==(r=n[s++]);)u=r.name,c=r.index,d=H[u].itemObjs[c],a=document.createElement("li"),a.setAttribute("data-name",u),a.setAttribute("data-index",c),h=d instanceof _?e:d.text,a.appendChild(document.createTextNode(h)),this.hideTag===!1&&(l=H[u].title,""!==l&&void 0!==l&&(o=document.createElement("span"),o.className=this.tagClass,o.appendChild(document.createTextNode(l)),a.appendChild(o))),compatibleJs.addEventListener(a,"click",i),g.appendChild(a);this.setMenuNodeFn(g)}},R.prototype.createSelectMenuFn=function(e,t,n){this.setTypeFn("select"),this.id="ssj-menu-"+J,this["class"]=D.menuClass,this.hideTag=D.hideTag,this.firstItemHideFlag=!0,this.createBaseMenuFn(e,t,n,this.clickSelectItemEvent)},R.prototype.createMsgMenuFn=function(e,t){this.setTypeFn("msg"),this.id="ssj-msg-"+J,this["class"]=D.msgClass,this.hideTag=!0,this.firstItemHideFlag=!1,this.createBaseMenuFn(e,t,[],this.clickMsgItemEvent)},R.prototype.focusMenuItemFn=function(){var e=this.getMenuNodeFn();if(null===e)return!1;var t=e.children[+e.getAttribute("data-select")];if(t.offsetTop<this.scrollTop){var n=t.offsetTop+t.offsetHeight-this.offsetHeight;return void(this.scrollTop=0>n?0:n)}return t.offsetTop+t.offsetHeight>this.scrollTop+this.offsetHeight?void(this.scrollTop=t.offsetTop):void 0},R.prototype.createChangeMenuFn=function(e,t,n){this.setTypeFn("change"),this.id="ssj-change-"+J,this["class"]=D.menuClass,this.hideTag=D.hideTag,this.firstItemHideFlag=!1,this.createBaseMenuFn(e,t,n,this.clickChangeItemEvent)},R.prototype.clickSelectItemEvent=function(e){var t,n,i,a,o,s,r,l,u=compatibleJs.eventCompatible(e),c=u.target;if("LI"!=c.tagName){if(c.className!=D.tagClass||"LI"!=c.parentNode.tagName)return;c=c.parentNode}t=c.parentNode,n=compatibleJs.arrayIndexOf(t.children,c),-1!==n&&0!==n&&(t.setAttribute("data-select",n),c.className="focus",i=t.getAttribute("data-auto-no"),a=i.split(","),o=X[a[0]],s=t.children[n].getAttribute("data-name"),r=+t.children[n].getAttribute("data-index"),l=H[s].itemObjs[r],l instanceof _&&l.setTextFn(t.children[0].textContent),o.setObjFn(l),a.length>1&&X.splice(a[1],a.length-1),O(a[0]),B.removeMenuNodeFn(),K.focus(),A(a[0]-1),u.preventDefault())},R.prototype.clickChangeItemEvent=function(e){var t,n,i,a,o,s,r,l,u=compatibleJs.eventCompatible(e),c=u.target;if("LI"!=c.tagName){if(c.className!=D.tagClass||"LI"!=c.parentNode.tagName)return;c=c.parentNode}t=c.parentNode,n=compatibleJs.arrayIndexOf(t.children,c),-1!==n&&(0===n||(t.setAttribute("data-select",n),c.className="focus",i=t.getAttribute("data-auto-no"),a=i.split(","),o=X[a[0]],s=t.children[n].getAttribute("data-name"),r=+t.children[n].getAttribute("data-index"),l=H[s].itemObjs[r],o.setObjFn(l),a.length>1&&X.splice(a[1],a.length-1),O(a[0])),B.removeMenuNodeFn(),K.focus(),A(),u.preventDefault())},R.prototype.clickMsgItemEvent=function(e){var t=compatibleJs.eventCompatible(e),n=t.target,i=n.parentNode,a=i.getAttribute("data-auto-no"),o=a.split(",");K.focus(),C(e,o[0]-1),t.preventDefault()},R.prototype.controlBaseEvent=function(e){var t=compatibleJs.eventCompatible(e),n=B.getMenuNodeFn();if(null!==n){if("msg"===B.getTypeFn())return B.controlMsgEvent(e),!0;var i=+n.getAttribute("data-select");switch(null===i&&(i=0),e.keyCode){case q.ESC:B.removeMenuNodeFn();break;case q.UP:n.children[i].className="",i--,0>i&&(i=n.childElementCount-1),n.children[i].className="focus",n.setAttribute("data-select",i),B.focusMenuItemFn();break;case q.DOWN:n.children[i].className="",i++,i>n.childElementCount-1&&(i=0),n.children[i].className="focus",n.setAttribute("data-select",i),B.focusMenuItemFn();break;case q.TAB:"select"===B.getTypeFn()&&0===i&&(i=1,n.children[i].className="focus",n.setAttribute("data-select",i));case q.ENTER:"select"===B.getTypeFn()?B.controlSelectEnterFn():"change"===B.getTypeFn()?B.controlChangeEnterFn():compatibleJs._warning("unknow BaseMenu.type"),t.preventDefault()}}},R.prototype.controlSelectEnterFn=function(){var e,t,n,i,a,o,s=B.getMenuNodeFn(),r=+s.getAttribute("data-select");null===r&&(r=0),e=s.getAttribute("data-auto-no"),t=e.split(","),n=X[t[0]],2==s.childElementCount&&(r=1),0===r?O(t[t.length-1]):(i=s.children[r].getAttribute("data-name"),a=s.children[r].getAttribute("data-index"),o=H[i].itemObjs[a],o instanceof _&&o.setTextFn(s.children[0].textContent),n.setObjFn(o),t.length>1&&X.splice(t[1],t.length-1),O(t[0])),B.removeMenuNodeFn(),A(t[0]-1)},R.prototype.controlChangeEnterFn=function(){var e,t,n,i,a,o,s=B.getMenuNodeFn(),r=+s.getAttribute("data-select");null===r&&(r=0),0===r?B.removeMenuNodeFn():(e=s.getAttribute("data-auto-no"),t=e.split(","),n=X[t[0]],i=s.children[r].getAttribute("data-name"),a=+s.children[r].getAttribute("data-index"),o=H[i].itemObjs[a],n.setObjFn(o),t.length>1&&X.splice(t[1],t.length-1),O(t[0])),B.removeMenuNodeFn(),A()},R.prototype.controlMsgEvent=function(e){var t=compatibleJs.eventCompatible(e);if(e.keyCode===q.ESC||e.keyCode===q.TAB||e.keyCode===q.ENTER){var n=B.getMenuNodeFn().getAttribute("data-auto-no"),i=n.split(",");C(e,i[0]-1),t.preventDefault()}},Z}var compatibleJs=function(){function e(e){e="Warning:  "+e,void 0!==console&&void 0!==console.warn?console.warn(e):config.debugMode===!0&&alert(e)}function t(e,t){var n;if(e.indexOf)return e.indexOf(t);for(n=0;n<e.length;n++)if(e[n]==t)return n;return-1}function n(e){var t=e.value.length;if(document.activeElement!==e)return t;if(void 0!==e.selectionStart)t=e.selectionStart;else if(document.selection){e.focus();var n=document.selection.createRange();n.moveStart("character",-e.value.length),t=n.text.length}return t}function i(e,t){if(document.activeElement===e)if(void 0!==e.selectionStart)e.selectionStart=t,e.selectionEnd=t;else if(document.selection){e.focus();var n=document.selection.createRange();n.moveStart("character",-e.value.length+t)}}function a(e,t,n,i){var a,o,s,r,l=[];if(document.querySelectorAll)a=(n?n:"")+"["+e+(void 0!==t?"='"+t+"'":"")+"]",l=(i||document).querySelectorAll(a);else for(o=(i||document).getElementsByTagName(n||"*"),s=0;void 0!==(r=o[s++]);)void 0!==t&&r.getAttribute(e)===t?l.push(r):void 0===t&&r.getAttribute(e)&&l.push(r);return l}function o(e,t,n){e.addEventListener?e.addEventListener(t,n):e.attachEvent("on"+t,n)}function s(e){function t(){e.preventDefault?e.preventDefault():e.returnValue=!1}function n(){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}e=e||window.event;var i=e.target||e.srcElement;return{type:e.type,target:i,preventDefault:t,stopPropagation:n}}return{warning:e,arrayIndexOf:t,getKeyinPosition:n,setKeyinPosition:i,getElementsByAttribute:a,addEventListener:o,eventCompatible:s}}();